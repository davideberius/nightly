#!/bin/bash

# not complete
[ -e stderr ] || exit 99
[ -e stdout ] || exit 99

if grep -q 'COMPLETE' stdout; then
    # capture extra information about the result

    t1=$(sed -n -e 's/^calculation  *simulation time:.*= \([0-9]*\) sec/\1/p' stdout)
    t2=$(sed -n -e 's/^full  *simulation time:.*= \([0-9]*\) sec/\1/p' stdout)
    echo "$t1,$t2" >result.txt

    exit 0
fi

# exit with error
grep -q 'Exited' stderr && exit 1
grep -q 'aborted:' stderr && exit 2
grep -q 'error:' stderr && exit 3


exit 99
